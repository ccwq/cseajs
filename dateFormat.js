/**
 * JavaScript Date instance methods
 * 时间对象处理格式化
 * @copyright 2012 Ken Snyder (kendsnyder at gmail dot com)
 * @version 3.4.1, June 2012 (http://sandbox.kendsnyder.com/date)
 * @license MIT http://www.opensource.org/licenses/MIT
 * https://github.com/kensnyder/date-prototype
 */
define(function (require, exports, module) {
    !function(){"use strict";function a(a,b){switch(b-String(a).length){case 2:return"00"+a;case 1:return"0"+a}return a}function b(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}var c=[],d={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:{add:function(a,b){var c=a.getDate();d.year.add(a,Math[b>0?"floor":"ceil"](b/12));var e=a.getMonth()+b%12;12==e?(e=0,a.setYear(a.getFullYear()+1)):-1==e&&(e=11,a.setYear(a.getFullYear()-1)),a.setMonth(e),a.getDate()!=c&&(a.add(-1,"month"),a.setDate(a.daysInMonth()))},diff:function(a,b){var c=a.getFullYear()-b.getFullYear(),d=a.getMonth()-b.getMonth()+12*c,e=a.getDate()-b.getDate();return d+e/30}},year:{add:function(a,b){a.setYear(a.getFullYear()+Math[b>0?"floor":"ceil"](b))},diff:function(a,b){return d.month.diff(a,b)/12}}},e=d;e.milliseconds=e.millisecond,e.seconds=e.second,e.minutes=e.minute,e.hours=e.hour,e.weeks=e.week,e.days=e.day,e.months=e.month,e.years=e.year;var f={succ:function(a){return this.clone().add(1,a||"day")},add:function(a,b){var c=d[b]||d.day;return"number"==typeof c?this.setTime(this.getTime()+c*a):c.add(this,a),this},diff:function(a,b,c){var e;if(a=Date.create(a),null===a)return 0/0;var f=d[b]||d.day;return e="number"==typeof f?(this.getTime()-a.getTime())/f:f.diff(this,a),c?e:Math[e>0?"floor":"ceil"](e)},_applyFormat:function(a,b){for(var e,c=a||b.defaultFormat,d="";c.length>0;)(e=c.match(b.matcher))?(d+=c.slice(0,e.index),d+=(e[1]||"")+this._applyFormatChar(e[2],b),c=c.slice(e.index+e[0].length)):(d+=c,c="");return d},_applyFormatChar:function(b,c){if(c.shortcuts&&c.shortcuts[b])return this._applyFormat(c.shortcuts[b],c);if(c.codes&&c.codes[b]){var d=c.codes[b].split("."),e=this["get"+d[0]]?this["get"+d[0]]():"";return d[1]&&(e=a(e,d[1])),e}return b},format:function(a){return a=a||Date.formatting.strftime.defaultFormat,a.indexOf("%")>-1?this.strftime(a):this.formatPhp(a)},getShortYear:function(){return this.getYear()%100},getMonthNumber:function(){return this.getMonth()+1},getMonthName:function(){return Date.MONTHNAMES[this.getMonth()]},getAbbrMonthName:function(){return Date.ABBR_MONTHNAMES[this.getMonth()]},getDayName:function(){return Date.DAYNAMES[this.getDay()]},getAbbrDayName:function(){return Date.ABBR_DAYNAMES[this.getDay()]},getDayOrdinal:function(){return Date.ORDINALNAMES[this.getDate()%10]},getHours12:function(){var a=this.getHours();return a>12?a-12:0==a?12:a},getAmPm:function(){return this.getHours()>=12?"PM":"AM"},getAmPmLower:function(){return this.getHours()>=12?"pm":"am"},getUnix:function(){return Math.round(this.getTime()/1e3,0)},getUTCOffset:function(){var b=this.getTimezoneOffset()/60,c=0>b?"+":"-";return b=Math.abs(b),c+a(Math.floor(b),2)+":"+a(60*(b%1),2)},setUTCOffset:function(a){var b=-1*this.getTimezoneOffset(),c=this.getTime()+6e4*b;return this.setTime(c-6e4*a),this},setUTCOffsetString:function(a){var b=a.match(/([+-]?)([01]\d|2[0-3])\:?([0-5]\d)/);if(b){var c=60*parseFloat(b[2]);c+=parseFloat(b[3]),"-"==b[1]&&(c*=-1),this.setUTCOffset(c)}return this},getUTCOffsetNumber:function(){return this.getUTCOffset().replace(":","")},getTimezoneName:function(){var a=/(?:\((.+)\)$| ([A-Z]{3}) )/.exec(this.toString());return a[1]||a[2]||"GMT"+this.getUTCOffset()},toYmdInt:function(){return 1e4*this.getFullYear()+100*this.getMonthNumber()+this.getDate()},clone:function(){return new Date(this.getTime())},diffText:function(a){var d,b=this.diff(a||Date.current(),"seconds"),c=Math.abs(b);if(120>c)return b>=0?"in a moment":"moments ago";if(3600>c)d=floor(c/60)+" minutes";else if(86400>c){var e=floor(c/3600),f=1==hour?"":"s";d=e+" hour"+f+" ago"}else{if(172800>c)return b>0?"tomorrow":"yesterday";if(604800>c)d=floor(c/86400)+" days";else{if(1209600>c)return b>0?"next week":"last week";if(2419200>c)d=floor(c/604800)+" weeks";else{if(5184e3>c)return b>0?"next month":"last month";if(31536e3>c)d=floor(c/2592e3)+" months";else{if(63072e3>c)return b>0?"next year":"last year";d=floor(c/31536e3)+" years"}}}}return b>0?"in "+d:d+" ago"},daysInMonth:function(){return Date.daysInMonth(this.getFullYear(),this.getMonth()+1)},isLeapYear:function(){return 29==Date.daysInMonth(this.getFullYear(),1)?1:0},isBefore:function(a,b){return Math.round(this.diff(a,b||"milliseconds",!0),0)<0},isAfter:function(a,b){return Math.round(this.diff(a,b||"milliseconds",!0),0)>0},equals:function(a,b){return 0==Math.round(this.diff(a,b||"milliseconds",!0),0)},schedule:function(a){var b=this.getTime()-Date.current().getTime(),d=this.clone();if(0>=b)return d.unschedule(a),a(),this;var e=this.getTime(),f=setTimeout(function(){d.unschedule(a),a()},b);return c.push({callback:a,timestamp:e,timeoutId:f}),this},unschedule:function(a){for(var b=c.length,d=this.getTime();b--;)c[b].callback==a&&c[b].timestamp==d&&(clearTimeout(c[b].timeoutId),c.splice(b,1));return this},getSchedule:function(){for(var a=[],b=this.getTime(),d=0,e=c.length;e>d;d++)c[d].timestamp==b&&a.push(c[d]);return a}};b(Date.prototype,f),Date.prototype.toISOString||(Date.prototype.toISOString=function(){return this.setUTCOffset(0).strftime(Date.ISO)});var g={create:function(a){if("undefined"==typeof a)return Date.current();if(a instanceof Date)return a;var b=arguments;switch(b.length){case 1:if("[object Number]"==Object.prototype.toString.call(a))return new Date(a);if(a=String(a).replace(/^\s*(.*)\s*$/,"$1"),a=a.replace(/\s{2,}/g," "),""===a)return Date.current();for(var d,e,f,g,h,i,c=0;d=Date.create.patterns[c++];)if("string"==typeof d[0]?(h=d[1],i=d[2]):(h=d[0],i=d[1]),g=a.match(h))if("function"==typeof i){if(f=i(g,a),f instanceof Date)return f}else if(e=Date.parse(a.replace(h,i)),!isNaN(e))return new Date(e);return 0/0;case 2:return new Date(b[0],b[1],1);case 3:return new Date(b[0],b[1],b[2]);case 4:return new Date(b[0],b[1],b[2],b[3]);case 5:return new Date(b[0],b[1],b[2],b[3],b[4]);case 6:return new Date(b[0],b[1],b[2],b[3],b[4],b[5]);default:return new Date(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}},MONTHNAMES:"January February March April May June July August September October November December".split(" "),MONTHNAMES_LOOKUP:{jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},ABBR_MONTHNAMES:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAYNAMES:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),DAYNAMES_LOOKUP:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},ABBR_DAYNAMES:"Sun Mon Tue Wed Thu Fri Sat".split(" "),ORDINALNAMES:"th st nd rd th th th th th th".split(" "),ISO:"%Y-%m-%dT%H:%M:%S.%N%G",SQL:"%Y-%m-%d %H:%M:%S",SCRIPT_LOAD:new Date,daysInMonth:function(a,b){return 2==b?29==new Date(a,1,29).getDate()?29:28:[void 0,31,void 0,31,30,31,30,31,31,30,31,30,31][b]},getMonthByName:function(a){return Date.MONTHNAMES_LOOKUP[String(a).slice(0,3).toLowerCase()]},getWeekdayByName:function(a){return Date.DAYNAMES_LOOKUP[String(a).slice(0,3).toLowerCase()]},autoFormat:function(a,b){a="string"==typeof a?document.getElementById(a):a;var c=function(){var c=Date.create(a.value);c&&(a.value=c.format(b))};return"function"==typeof a.attachEvent?a.attachEvent("onblur",c):"function"==typeof a.addEventListener?a.addEventListener("blur",c,!1):a.onblur=c,a},addFormat:function(a,b){return Date.prototype[a]=function(a){return this._applyFormat(a,b)},this},addPattern:function(a,b){if(b)for(var d,c=0;d=Date.create.patterns[c++];)if(d[0]==b||d[1]==b)return Date.create.patterns.splice(c,0,a),this;return Date.create.patterns.unshift(a),this},removePattern:function(a){for(var c,b=0;c=Date.create.patterns[b++];)if(c[0]==a||c[1]==a)return Date.create.patterns.splice(b-1,1)[0];return!1},current:function(){return new Date}};b(Date,g),"now"in Date||(Date.now=function(){return Date.current().setUTCOffset(0).getTime()});var h={};Date.Timer=function(a){return a===h?this:this.initialize.apply(this,Array.prototype.slice.call(arguments))},Date.Timer.prototype.initialize=function(){return this},Date.Timer._now=window.performance&&window.performance.now?function(){return window.performance.now()}:window.performance&&window.performance.webkitNow?function(){return window.performance.webkitNow()}:function(){return 1e3*(new Date).getTime()},Date.Timer.prototype.start=Date.Timer.restart=function(){return this._startSnapshot=Date.Timer._now(),this.startDate=new Date,this},Date.Timer.prototype.clone=function(){var a=new Date.time(h);return a._startSnapshot=this._startSnapshot,a.startDate=this.startDate,a},Date.Timer.prototype.stop=function(a,b){if(b){var c=this.stop(a);return b.replace("%s",c).replace(/%?\.(\d+)f/i,function(a){return retult.toFixed(+a[1])})}this._stopSnapshot=Date.Timer._now(),this.stopDate=new Date;var d=this._stopSnapshot-this._startSnapshot;switch(String(a).toLowerCase()){case"microseconds":case"microsecond":return d;case"milliseconds":case"millisecond":default:return d/1e3;case"seconds":case"second":return d/1e6;case"minutes":case"minute":return d/6e7;case"hours":case"hour":return d/36e8;case"days":case"day":return d/864e8}},Date.addFormat("strftime",{matcher:/()%(#?(%|[a-z]))/i,defaultFormat:"%Y-%m-%d %H:%M:%s",codes:{Y:"FullYear",y:"ShortYear.2",m:"MonthNumber.2","#m":"MonthNumber",B:"MonthName",b:"AbbrMonthName",d:"Date.2","#d":"Date",e:"Date",A:"DayName",a:"AbbrDayName",w:"Day",o:"DayOrdinal",H:"Hours.2","#H":"Hours",I:"Hours12.2","#I":"Hours12",P:"AmPmLower",p:"AmPm",M:"Minutes.2","#M":"Minutes",S:"Seconds.2","#S":"Seconds",s:"Unix",N:"Milliseconds.3","#N":"Milliseconds",O:"TimezoneOffset",Z:"TimezoneName",G:"UTCOffset"},shortcuts:{F:"%Y-%m-%d",T:"%H:%M:%S",X:"%H:%M:%S",x:"%m/%d/%y",D:"%m/%d/%y","#c":"%a %b %e %H:%M:%S %Y",v:"%e-%b-%Y",R:"%H:%M",r:"%I:%M:%S %p",t:"	",n:"\n","%":"%"}}),Date.addFormat("formatPhp",{matcher:/(\\)?([a-z])/i,defaultFormat:"Y-m-d H:i:s",codes:{Y:"FullYear",y:"ShortYear.2",L:"isLeapYear",m:"MonthNumber.2",n:"MonthNumber",F:"MonthName",M:"AbbrMonthName",t:"daysInMonth",d:"Date.2",j:"Date",l:"DayName",D:"AbbrDayName",w:"Day",S:"DayOrdinal",H:"Hours.2",G:"Hours",h:"Hours12.2",g:"Hours12",a:"AmPmLower",A:"AmPm",i:"Minutes.2",s:"Seconds.2",U:"Unix",Z:"TimezoneOffset",e:"TimezoneName",P:"UTCOffset",O:"UTCOffsetNumber"},shortcuts:{c:"Y-m-d\\TH:i:sP",r:"D, j M Y H:i:s O"}});for(var l,i={matcher:/()(mi|am|pm|ss|yyyy|yy|m{1,4}|d{1,4}|w|hh?24|hh?12)/i,defaultFormat:"yyyy-mm-dd hh24:mi:ss",codes:{yyyy:"FullYear",yy:"ShortYear.2",mm:"MonthNumber.2",m:"MonthNumber",mmm:"AbbrMonthName",mmmm:"MonthName",dd:"Date.2",d:"Date",ddd:"AbbrDayName",dddd:"DayName",w:"Day",hh24:"Hours.2",h24:"Hours",hh:"Hours12.2",hh12:"Hours12.2",h12:"Hours12",am:"AmPm",pm:"AmPm",mi:"Minutes.2",ss:"Seconds.2"},shortcuts:{}},j="yyyy yy mm m mmm mmmm dd d ddd dddd w hh24 h24 hh12 h12 am pm mi ss".split(" "),k=0;l=j[k++];)i.codes[l.toUpperCase()]=i.codes[l];Date.addFormat("formatSql",i),Date.create.regexes={YEAR:"[1-9]\\d{3}",MONTH:"1[0-2]|0?[1-9]",MONTH2:"1[0-2]|0[1-9]",MONTHNAME:"jan|january|feb|february|mar|march|apr|april|may|jun|june|jul|july|aug|august|sep|september|oct|october|nov|november|dec|december",DAYNAME:"mon|monday|tue|tuesday|wed|wednesday|thu|thursday|fri|friday|sat|saturday|sun|sunday",DAY:"3[01]|[12]\\d|0?[1-9]",DAY2:"3[01]|[12]\\d|0[1-9]",TIMEZONE:"[+-][01]\\d\\:?[0-5]\\d",H24:"[01]\\d|2[0-3]",MIN:"[0-5]\\d",SEC:"[0-5]\\d",MS:"\\d{3,}",H12:"0?[1-9]|1[012]",AMPM:"am|pm",UNIT:"year|month|week|day|hour|minute|second|millisecond"},Date.create.makePattern=function(a){return a=a.replace(/_([A-Z][A-Z0-9]+)_/g,function(a,b){return Date.create.regexes[b]}),new RegExp(a,"i")},Date.create.patterns=[["iso_8601",Date.create.makePattern("^(_YEAR_)-(_MONTH_)-(_DAY_)$"),"$2/$3/$1"],["us",Date.create.makePattern("^(_MONTH_)([\\/-])(_DAY_)\\2(_YEAR_)$"),"$1/$3/$4"],["world",Date.create.makePattern("^(_DAY_)([\\/\\.])(_MONTH_)\\2(_YEAR_)$"),"$3/$1/$4"],["chicago",Date.create.makePattern("^(?:(?:_DAYNAME_),? )?(_DAY_)([ -])(_MONTHNAME_)\\2(_YEAR_)$"),"$3 $1, $4"],["conversational",Date.create.makePattern("^(?:(?:_DAYNAME_),? )?(_MONTHNAME_) (_DAY_),? (_YEAR_)$"),"$1 $2, $3"],["month_day_time_year",Date.create.makePattern("^(?:_DAYNAME_) (_MONTHNAME_) (_DAY_) ((?:_H24_)\\:(?:_MIN_)(?:\\:_SEC_)?) (_TIMEZONE_) (_YEAR_)$"),function(b){var c=a(Date.getMonthByName(b[1]),2),d=a(b[2],2),e=Date.create(b[5]+"-"+c+"-"+d+"T"+b[3]+b[4]);return isNaN(e)?!1:e}],["unix",/^@(-?\d+)$/,function(a){return Date.create(1e3*parseInt(a[1],10))}],["24_hour",Date.create.makePattern("^(?:(.+?)(?: |T))?(_H24_)\\:(_MIN_)(?:\\:(_SEC_)(?:\\.(_MS_))?)? ?(?:GMT)?(_TIMEZONE_)?(?: \\([A-Z]+\\))?$"),function(a){var b;if(a[1]){if(b=Date.create(a[1]),isNaN(b))return!1}else b=Date.current(),b.setMilliseconds(0);return b.setHours(parseFloat(a[2]),parseFloat(a[3]),parseFloat(a[4]||0)),a[5]&&b.setMilliseconds(+String(a[5]).slice(0,3)),a[6]&&b.setUTCOffsetString(a[6]),b}],["12_hour",Date.create.makePattern("^(?:(.+) )?(_H12_)(?:\\:(_MIN_)(?:\\:(_SEC_))?)? ?(_AMPM_)$"),function(a){var b;if(a[1]){if(b=Date.create(a[1]),isNaN(b))return!1}else b=Date.current(),b.setMilliseconds(0);var c=parseFloat(a[2]);return c="am"==a[5].toLowerCase()?12==c?0:c:12==c?12:c+12,b.setHours(c,parseFloat(a[3]||0),parseFloat(a[4]||0)),b}],["weeks_months_before_after",Date.create.makePattern("^(\\d+) (_UNIT_)s? (before|from|after) (.+)$"),function(a){var b=Date.create(a[4]);return b instanceof Date?b.add(("before"==a[3].toLowerCase()?-1:1)*a[1],a[2]):!1}],["time_ago",Date.create.makePattern("^(\\d+) (_UNIT_)s? ago$"),function(a){return Date.current().add(-1*a[1],a[2])}],["in_time",Date.create.makePattern("^in (\\d) (_UNIT_)s?$"),function(a){return Date.current().add(a[1],a[2])}],["plus_minus",Date.create.makePattern("^([+-]) ?(\\d+) (_UNIT_)s?$"),function(a){var b="-"==a[1]?-1:1;return Date.current().add(b*a[2],a[3])}],["asp_json",/^\/Date\((\d+)([+-]\d{4})?\)\/$/i,function(a){var b=new Date;return b.setTime(a[1]),a[2]&&b.setUTCOffsetString(a[2]),b}],["today_tomorrow",/^(today|now|tomorrow|yesterday)/i,function(a){var b=Date.current();switch(a[1].toLowerCase()){case"today":case"now":return b;case"tomorrow":return b.add(1,"day");case"yesterday":return b.add(-1,"day")}}],["this_next_last",Date.create.makePattern("^(this|next|last) (?:(_UNIT_)s?|(_MONTHNAME_)|(_DAYNAME_))$"),function(a){var e,f,g,b="last"==a[1].toLowerCase()?-1:1,c=Date.current();return a[2]?c.add(b,a[2]):a[3]?(f=Date.getMonthByName(a[3])-1,e=12-(c.getMonth()-f),e=e>12?e-12:e,c.add(b*e,"month")):a[4]?(g=Date.getWeekdayByName(a[4]),e=c.getDay()-g+7,c.add(b*(0==e?7:e),"day")):!1}],["conversational_sans_year",Date.create.makePattern("^(_MONTHNAME_) (?:the )?(\\d+)(?:st|nd|rd|th)?$"),function(a){var b=Date.current();return a[1]&&b.setMonth(Date.getMonthByName(a[1])-1),b.setDate(a[2]),b}]],"undefined"!=typeof module&&module.exports?module.exports=Date.create:"function"==typeof define&&define(function(){return Date.create}),"undefined"!=typeof window&&(window.$D=Date.create)}();
    return window.$D;
});